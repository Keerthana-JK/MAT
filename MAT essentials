public class MedicationSchedulesRepo
{
    public void CreateMedicationSchedules(Medication medication, YourDbContext context)
    {
        // Create an instance of the schedule generator
        MedicationScheduleGenerator scheduleGenerator = new MedicationScheduleGenerator();

        // Generate the scheduled times
        List<DateTime> scheduledTimes = scheduleGenerator.GenerateScheduledTimes(medication.StartDate, medication.EndDate, medication.Frequency);

        foreach (var scheduledTime in scheduledTimes)
        {
            MedicationSchedule newSchedule = new MedicationSchedule
            {
                MedicationID = medication.MedicationID, // Assuming this is set properly
                ScheduledTime = scheduledTime,
                Status = "Pending", // Default status
                CreatedAt = DateTime.Now
            };

            // Save the new schedule to the same context
            context.MedicationSchedules.Add(newSchedule);
        }
    }
}
